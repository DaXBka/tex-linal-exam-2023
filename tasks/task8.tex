\task{8}
\begin{condition}
    Линейный оператор $\varphi \colon \R^4 \to \R^4$ имеет в стандартном базисе матрицу
    \[
        \begin{pmatrix}
            1  & 3 & 3  & 1 \\
            0  & 2 & 4  & 0 \\
            0  & 0 & 2  & 0 \\
            -2 & 5 & -6 & 4
        \end{pmatrix}
    \]
    Найдите базис пространства $\R^4$, в котором матрица оператора $\varphi$ имеет жорданову форму, и укажите эту жорданову форму.
\end{condition}

Найдём значения спектра линейного оператора через характеристический многочлен. Пусть исходная матрица равна $A$, тогда:
\[
    \chi_\varphi(t) = (-1)^4 \det(A - tE) =
    \begin{vmatrix}
        1 - t & 3     & 3     & 1     \\
        0     & 2 - t & 4     & 0     \\
        0     & 0     & 2 - t & 0     \\
        -2    & 5     & -6    & 4 - t
    \end{vmatrix}
    =
    (2 - t) \cdot
    \begin{vmatrix}
        1 - t & 3     & 1     \\
        0     & 2 - t & 0     \\
        -2    & 5     & 4 - t
    \end{vmatrix}
    =
\]
\[
    = (2 - t)((1 - t)(2 - t)(4 - t) + 2(2 - t)) = (t - 2)^3(t - 3) \implies 2, 3 \in \Spec \varphi
\]

Пусть $B_t = A - tE$, узнаем количество жордановых клеток для собственного значения 2:
\[
    B_2 = A - 2E =
    \begin{pmatrix}
        -1 & 3 & 3  & 1 \\
        0  & 0 & 4  & 0 \\
        0  & 0 & 0  & 0 \\
        -2 & 5 & -6 & 2
    \end{pmatrix}
    \;
    \implies
    \;
    \rk B_2 = 3
    \;
    \implies
    \;
    d_1 = 4 -3 = 1 \text{ клетка}
\]
С учётом того, что алгебраическая кратность значения 2 равна 3 и для него определена только одна клетка - эта жорданова клетка размера 3 на 3. В таком случае, для собственного значения 3 у нас остаётся только один вариант - клетка 1 на 1, то есть для него существует собственный вектор.

Пусть $\f$ - искомый базис для линейного оператора $\varphi$, тогда его матрица примет вид:
\[
    A(\varphi, \f)
    =
    \begin{pmatrix}
        2 & 1 & 0 & 0 \\
        0 & 2 & 1 & 0 \\
        0 & 0 & 2 & 0 \\
        0 & 0 & 0 & 3
    \end{pmatrix}
    \text{ - ЖНФ}
\]

Остаётся дело за малым - предъявить базис, в котором матрица примет вид, описанный выше. Начнём с простого - найдём собственный вектор, отвечающий собственному значению 3 через ФСР:
\[
    B_3 = A - 3E =
    \begin{pmatrix}
        -2 & 3  & 3  & 1 \\
        0  & -1 & 4  & 0 \\
        0  & 0  & -1 & 0 \\
        -2 & 5  & -6 & 1
    \end{pmatrix}
    \leadsto
    \begin{pmatrix}
        1 & 0 & 0 & -\d{1}{2} \\
        0 & 1 & 0 & 0         \\
        0 & 0 & 1 & 0         \\
        0 & 0 & 0 & 1
    \end{pmatrix}
    \implies
    V_3(\varphi) =
    \langle
    \underbrace{
        \begin{pmatrix}
            \d{1}{2} \\
            0        \\
            0        \\
            1
        \end{pmatrix}
    }_{f_4}
    \rangle
    =
    \langle f_4 \rangle
\]

\newpage

Далее, для значения 2 у нас 1 клетка размера $3 \times 3$, поэтому как $f_3$ нам требуется найти такой вектор, для которого выполняется:
\[
    \vht f_3 = 3, \; f_3  \in \Ker B_2^3
\]

Вычислим матрицу $B_2^3$:
\[
    B_3^2 =
    \begin{pmatrix}
        -1 & 3 & 3  & 1 \\
        0  & 0 & 4  & 0 \\
        0  & 0 & 0  & 0 \\
        -2 & 5 & -6 & 2
    \end{pmatrix}^3
    =
    \begin{pmatrix}
        -1 & 2 & -1 & 1 \\
        0  & 0 & 0  & 0 \\
        0  & 0 & 0  & 0 \\
        -2 & 4 & -2 & 2
    \end{pmatrix}
\]

Найдём базис ядра матрицы $B_2^3$ через ФСР:
\[
    B_2^3 =
    \begin{pmatrix}
        -1 & 2 & -1 & 1 \\
        0  & 0 & 0  & 0 \\
        0  & 0 & 0  & 0 \\
        -2 & 4 & -2 & 2
    \end{pmatrix}
    \leadsto
    \begin{pmatrix}
        1 & -2 & 1 & -1 \\
        0 & 0  & 0 & 0  \\
        0 & 0  & 0 & 0  \\
        0 & 0  & 0 & 0
    \end{pmatrix}
    \implies
    \Ker B_2^3 =
    \langle
    \begin{pmatrix}
        2 \\
        1 \\
        0 \\
        0
    \end{pmatrix},\;
    \begin{pmatrix}
        -1 \\
        0  \\
        1  \\
        0
    \end{pmatrix},\;
    \begin{pmatrix}
        1 \\
        0 \\
        0 \\
        1
    \end{pmatrix}
    \rangle
\]

Промерив ручками, приходим к тому, что высоту 3 имеет только второй вектор. Берём его как $f_3$:
\[
    f_3 =
    \begin{pmatrix}
        -1 \\
        0  \\
        1  \\
        0
    \end{pmatrix}
    \;\implies\;
    f_2 = B_2f_3 =
    \begin{pmatrix}
        4 \\
        4 \\
        0 \\
        -4
    \end{pmatrix}
    \;\implies\;
    f_1 = B_2f_2 =
    \begin{pmatrix}
        4 \\
        0 \\
        0 \\
        4
    \end{pmatrix}
\]

\textbf{Обязательно:} Проверим, что набор $\f := (f_1, f_2, f_3, f_4)$ является \textit{линейно независимым}:
\[
    \begin{pmatrix}
        f_1 & f_2 & f_3 & f_4
    \end{pmatrix}
    =
    \begin{pmatrix}
        4 & 4  & -1 & \d{1}{2} \\
        0 & 4  & 0  & 0        \\
        0 & 0  & 1  & 0        \\
        4 & -4 & 0  & 1
    \end{pmatrix}
    \leadsto
    \begin{pmatrix}
        4 & 0 & -1 & \d{1}{2} \\
        0 & 4 & 0  & 0        \\
        0 & 0 & 1  & 0        \\
        0 & 0 & 0  & \d{1}{2}
    \end{pmatrix}
    \implies \f \text{ - базис в } \R^4
\]

\answer{8}
\begin{itemize}
    \item Базис
          $\f =
              (
              \begin{pmatrix}
                  4 \\
                  0 \\
                  0 \\
                  4
              \end{pmatrix},\;
              \begin{pmatrix}
                  4 \\
                  4 \\
                  0 \\
                  -4
              \end{pmatrix},\;
              \begin{pmatrix}
                  -1 \\
                  0  \\
                  1  \\
                  0
              \end{pmatrix},\;
              \begin{pmatrix}
                  \d{1}{2} \\
                  0        \\
                  0        \\
                  1
              \end{pmatrix}
              )
          $.

    \item Жорданова форма $
              A(\varphi, \f) =
              \begin{pmatrix}
                  2 & 1 & 0 & 0 \\
                  0 & 2 & 1 & 0 \\
                  0 & 0 & 2 & 0 \\
                  0 & 0 & 0 & 3
              \end{pmatrix}
          $.
\end{itemize}
